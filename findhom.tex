% this is a part of the habilitation thesis of Max Neunhoeffer

\chapter{Finding homomorphisms}
\label{chap:findhom}

In the previous Chapter~\ref{chap:comptree} we have formulated the problem
of constructive recognition of groups in Problem~\ref{ProbCR3} and have
explained what a reduction is. This chapter describes how to find
reductions for matrix groups and projective groups and how to prove
that a certain collection of methods will for any given
matrix group or projective group either find a reduction
or show that the constructive 
recognition problem can be solved efficiently by other means. By the 
arguments in Chapter~\ref{chap:comptree} this solves
Problem~\ref{ProbCR3} whenever the ambient group is $\GL(n,q)$ or
$\PGL(n,q)$.

We use two fundamental theoretical tools. The first is Aschbacher's theorem
about the subgroup structure of the classical groups, which we describe
in detail for the case of $\GL(n,q)$ in Section~\ref{sect:aschbacher},
and the second is the classification of finite simple groups. We are
content with the statements in Aschbacher's theorem about the general
linear group since they suffice for the purposes of constructive
recognition and the statements and arguments are quite a bit simpler
than for the other classical groups. For details see \cite{aschbacher}.

Roughly speaking, Aschbacher's theorem states that every subgroup of $\GL(n,q)$
is either a member of at least one of $7$ concretely given classes 
\CC1 to \CC7 of 
subgroups, or it contains a classical group in its natural representation, 
or it is an almost-simple group modulo scalars.

All the classes \CC1 to \CC7 are somehow defined in a geometric way (see
Sections~\ref{descC1} to \ref{descC7}) and thus promise some kind of
reduction. The two other cases are covered by two further classes \CC8
and \CC9, which are described in Sections~\ref{descC8} and \ref{descC9}.
For members of the latter two classes one will usually have to solve the
constructive recognition problem without further reduction.
% FIXME

The idea is to provide efficient algorithms for all the classes \CC1 to
\CC7 to recognise whether a given matrix group lies in the class, and if
so, to find a reduction using this information. If none of these algorithms
succeeds, Aschbacher's theorem shows that the group must be a member of
\CC8 or \CC9. In that case the constructive recognition problem has to be
solved by different means, usually by first finding out which classical
or almost simple group it is and then using this information to do the
constructive recognition in a special case, for example using standard
generators (see Sections~\ref{solveC8} and \ref{solveC9}).

The purpose of this chapter is to explain the statement of Aschbacher's 
theorem for $\GL(n,q)$ in detail, to give a proof and to give an
overview over the known methods to deal with the different classes
together with references into the literature. An algorithm to recognise
and handle classes \CC3 and \CC5 provided that the group does not lie in
class \CC1 is described in detail in Chapter~\ref{chap:subsemi}.

\section{A variant of Aschbacher's Theorem}
\label{sect:aschbacher}

Note again that we restrict ourselves to the general linear group
throughout, which is only a special case of Aschbacher's Theorem.

\begin{Not}
For this section we fix $n \in \N$ and $q=p^e$ for a prime $p$ and
talk about the group $\GL(n,q)$. We denote the vector space $\F_q^{1
\times n}$ by $V$ and note that $\GL(n,q)$ acts from the right on $V$ by
vector-matrix multiplication.
\end{Not}

For the original formulation of his theorem in \cite{aschbacher}, Aschbacher 
defines $8$ classes
of subgroups of $\GL(n,q)$ and proves that every subgroup $G$ is either
a subgroup of some member of one of these $8$ classes or has a certain
list of properties. We change this formulation in the following
way: Instead of the original 8 Aschbacher class \CC 1 to \CC 8
we define different classes \DD 1 to \DD 8
(for details see the descriptions in Sections \ref{descC1} to
\ref{descC8}).
Furthermore, we collect
the subgroups $G \le \GL(n,q)$ that fulfil the properties in the statement of 
Aschbacher's Theorem in the class \DD9. The slight modifications 
to the class definitions on the one hand stem from our proof of the
theorem, on the other hand they are motivated in the following way: We try
to increase the number of subgroups contained in classes that can be
handled algorithmically well and try to decrease the number of subgroups
contained in classes for which the known algorithms are not yet completely
satisfying, mostly with respect to their complexity analysis.
In addition we try to reduce the overlap between the classes.

We formulate a variant of Aschbacher's Theorem in the following way:

\begin{Theo}[Variant of Aschbacher's Theorem, specialised to\/ $\GL(n,q)$]
\label{Asch}
Let $G$ be a subgroup of\/ $\GL(n,q)$ with $n \ge 2$.
Then $G$ is contained in at least one of the
classes \DD1 to \DD9 of subgroups described in Sections~\ref{descC1}
to \ref{descC9}.
\end{Theo}
\proofbeg Compare \cite[Appendix 2, Theorem 1]{RobPhd}, \cite{aschbacher}, 
\cite{kleilieb} and 
\cite[Theorem~1]{smashprim}. For a proof see Section~\ref{AschProof}.
\proofend

%\begin{Rem}
%In our description of the classes \CC1 to \CC9 we follow
%\cite{kleilieb}. Kleidman and Liebeck change the definition 
%slightly in comparison to Aschbacher but argue that Theorem~\ref{Asch}
%remains true with their definitions (see \cite[Chapter~4]{kleilieb}).
%FIXME
%\end{Rem}

\medskip
We proceed with our definition of the subgroup classes \DD1 to \DD9. Throughout,
we denote for a subgroup $G < \GL(n,q)$ its subgroup of scalar matrices
by $Z$, that is, $Z := Z(\GL(n,q)) \cap G$. For each class we either
give an alternate structural description or at least give the structure 
of some ``typical'' example groups in that class.

\subsection{Description of class \DD1: ``reducible''}
\label{descC1}

\newcommand{\desc}[1]{\begin{center}\fbox{\parbox{5.3in}{#1}}\end{center}}
\newcommand{\diffasch}[1]{\textbf{Differences to Aschbacher's class \CC#1:}}
\newcommand{\stru}{\textbf{Alternate structure description:}\par}
\newcommand{\exmemb}{\textbf{Example members:}\par}

\desc{
A group $G \le \GL(n,q)$ is a member of \DD1 if there is a subspace
$0 < W < V$ that is stabilised by $G$, that is, $Wg = W$ for all $g \in G$.
}

\diffasch1
Our class \DD1 consists of all members of \CC1 and all their
subgroups.

\smallskip
\stru
A group lies in \DD1 if and only if it is conjugate in $\GL(n,q)$ 
to a subgroup of a group
\[ P_m := \left\{ \left[ \begin{array}{cc} A & 0 \\ C & D \end{array} \right]
           \mid A \in \GL(m,q), D \in \GL(n-m,q) \mbox{ and }
           C \in \F_q^{n-m \times m} \right\} \]
for some $0 < m < n$. The group $P_m$ is called a \emph{maximal parabolic
subgroup} and is a semidirect product
of the normal $p$-subgroup
\[ U_m := \left\{ \left[ \begin{array}{cc} \one_m & 0 \\ C & \one_{n-m} 
           \end{array} \right]
           \mid 
           C \in \F_q^{n-m \times m} \right\} \]
and $\GL(m,q) \times \GL(n-m,q)$, the factors being embedded on the
diagonal blocks. 
Here, $\one_m$ is the $(m \times m)$-identity matrix and $\one_{n-m}$ is the
$(n-m) \times (n-m)$-identity matrix.

\subsection{Description of class \DD2: ``imprimitive''}
\label{descC2}

\desc{
A group $G \le \GL(n,q)$ is a member of \DD2 if the natural module $V$ is
absolutely irreducible and there is a decomposition
of $V$ as a direct sum of $m$-dimensional subspaces 
$V = V_1 \oplus \cdots \oplus V_t$
such that the summands are permuted transitively by $G$. That is, 
for every $1 \le i \le t$ and every 
$g \in G$ there is a $j$ with $V_i g = V_j$ and the action on the
summands is transitive.
}

\diffasch2
We include in \DD2 the subgroups of the members of \CC2 that
permute the direct summands transitively, but we exclude all groups
acting not absolutely irreducibly.

\smallskip
\exmemb
The groups $\GL(m,q) \wr S_t$, where the $\GL(m,q)$ factors act on
the direct summands $V_i$ and the symmetric group on top permutes the
subspaces, all lie in \DD2. Subgroups of these groups belong to \DD2
if they act irreducibly.


\subsection{Description of class \DD3: ``semilinear''}
\label{descC3}

\desc{
A group $G \le \GL(n,q)$ lies in \DD3 if the natural module $V$ is
irreducible and there is a finite field
extension $\F_{q^s}$ of $\F_q$,
for which we can extend the $\F_q$-vector space structure of
$V$ to an $\F_{q^s}$-vector space structure of dimension
$n/s$, such that for every $g \in G$ there exists 
an automorphism $\alpha_g$ of $\F_{q^s}$ with
\[ (v+\lambda w)\cdot g = v \cdot g + \lambda^{\alpha_g} \cdot w \cdot
g\]
for all $v,w \in V$ and all $\lambda \in \F_{q^s}$. This means that we
can interpret $V$ as an $\F_{q^s}$-vector space for which the natural action
of $G$ is $\F_{q^s}$-semilinear, so $G$ is a subgroup of $\GGL(n/s,q^s)$.
}

Note that the automorphisms of $\F_{q^s}$ occurring in the semilinear
actions of group elements will automatically fix every element of $\F_q$, 
since the original action is $\F_q$-linear. Therefore they are elements of
the Galois group $\Gal(\F_{q^s}/\F_q)$. Note further that
the group $G$ lies in \DD3 
with trivial automorphisms $\alpha_g$ for all $G$ if and only if
$V$ is irreducible but not absolutely irreducible (see \cite[(29.13)]{CR0}).

\medskip
\diffasch3
We include in \DD3 all subgroups of the members of \CC3, but we exclude all
groups acting reducibly.

\smallskip
\stru
A group lies in \DD3 if and only if it acts irreducibly on the natural
module and is conjugate in $\GL(n,q)$ to a subgroup of $\GGL(n/s,q^s)$ for
some prime $s \mid n$, realised as $(n \times n)$-matrices over $\F_q$
by choosing an $\F_q$-basis of $\F_{q^s}$.


\subsection{Description of class \DD4: ``tensor-decomposable''}
\label{descC4}

%%% % Old version:
%%% \desc{
%%% A group $G \le \GL(n,q)$ lies in class \DD4 if there is a decomposition
%%% of $V = V_1 \otimes V_2$ into a tensor product with 
%%% $1 < d_1 := \dim_{\F_q}(V_1) < n$
%%% and $d_2 := \dim_{\F_q}(V_2)$ that is preserved by $G$, 
%%% that is, for every $g \in
%%% G$ there are elements $g_1 \in \End_{\F_q}(V_1)$ and $g_2 \in
%%% \End_{\F_q}(V_2)$ such that $(v_1 \otimes v_2) g = v_1 g_1 \otimes v_2 g_2$
%%% for all $v_1 \in V_1$ and $v_2 \in V_2$.
%%% }
\desc{
A group $G \le \GL(n,q)$ lies in class \DD4 if the natural module $V$ is
absolutely irreducible and $G$ has a normal subgroup $N$
such that $V|_N$ is isomorphic as an $\F_q N$-module to a direct sum of
$k \ge 2$ modules which are all isomorphic to a single absolutely irreducible 
$\F_q N$-module $W$.
}

\diffasch4
We define \DD4 including more conditions on the structure of the
group and its natural representation than Aschbacher. The tensor
product decomposition in the definition of \CC4 follows from our
conditions, see Proposition~\ref{tensorprop}. On the other
hand we allow the dimensions of the tensor factors to be equal.

\smallskip
\exmemb
The group $\GL(d_1,q) \circ \GL(d_2,q)$ is the central
product of $\GL(d_1,q)$ and $\GL(d_2,q)$ for $d_1 \cdot d_2 = n$ and
thus is contained in $\GL(n,q)$. It is
the set of Kronecker products of a matrix in $\GL(d_1,q)$ and one in
$\GL(d_2,q)$. Those groups are members in \DD4.


\subsection{Description of class \DD5: ``subfield''}
\label{descC5}

\desc{
A group $G \le \GL(n,q)$ lies in \DD5 if the natural module $V$ is
absolutely irreducible and there exists a proper subfield $\F_{q_0}$
of $\F_q$, a matrix $T \in \GL(n,q)$, and scalars $(\beta_g)_{g \in
G}$ with $\beta_g \in \F_q$ such that $\beta_g \cdot T^{-1} g T \in
\GL(n,q_0)$ for all $g \in G$.}

\diffasch5
We include in \DD5 subgroups of the members of \CC5 but we exclude
all groups acting not absolutely irreducibly.

\smallskip
\stru
A group lies in \DD5 if and only if it is conjugate in $\GL(n,q)$ to a
subgroup of $\GL(n,q_0) \cdot \F_q^*$ where $\F_{q_0}$ is a 
proper subfield of $\F_q$.

\subsection{Description of class \DD6: ``extraspecial''}
\label{descC6}

\desc{
A group $G \le \GL(n,q)$ lies in \DD6 if the natural module $V$ is absolutely
irreducible, $n=r^m$ for a prime $r$ and
\begin{itemize}\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}
    \item \textbf{either} $r$ is odd and $G$ has a normal subgroup $E$ that 
is an extraspecial $r$-group of order $r^{1+2m}$ and exponent $r$,
\item \textbf{or} $r=2$ and $G$ has a normal subgroup $E$ that is either
    extraspecial of order $2^{1+2m}$ or a central product of a cyclic
    group of order $4$ with an extraspecial group of order $2^{1+2m}$,
\end{itemize}
\textbf{and} in both cases the linear action of $G$ on the
$\F_r$-vector space $E/Z(E)$ of dimension $2m$ is irreducible. }

\diffasch6
We have added the condition about the irreducible $\F_r$-linear action of $G$ on
$E/Z(E)$ because it comes out of our proof easily and might help to
devise algorithms to find a reduction for groups in this class. On the
other hand we include subgroups of members of \CC6 if they fulfil this
condition.

\smallskip
\exmemb
The following subgroups of $\GL(n,q)$ for suitable $(n,q)$ lie in \DD6:

$r^{1+2m}.\Sp(2m,r)$ and $2_+^{1+2m}.O^+(2m,2)$ and 
$2_-^{1+2m}.O^-(2m,2)$ and $(4 \circ 2^{1+2m}).\Sp(2m,2)$.


\subsection{Description of class \DD7: ``tensor-induced''}
\label{descC7}

\desc{
A group $G \le \GL(n,q)$ lies in \DD7 if it acts absolutely irreducibly on the 
natural module $V$ and, for some $k$, it has a normal 
subgroup $N$ containing $Z = Z(G)$ that is isomorphic to a central product 
$T \circ \cdots \circ T$ of
$k$ copies of a group $T$ which is a central extension of a non-abelian
simple group $\bar T$ by $Z$, such that: 

The restricted
module $V|_N$ is isomorphic to an outer tensor product $W_1 \otimes_{\F_q}
\cdots \otimes_{\F_q} W_k$ of $k$
absolutely irreducible $\F_q T$-modules of the same dimension on which 
$Z$ acts as scalars, and $G/N$ acts on $N$ by permuting the tensor factors
transitively.}

By the term ``outer tensor product'' we mean that every factor
$T$ in the central product $N$ acts on exactly one of the tensor factors $W_i$.
Note that the $\F_q T$-modules $W_i$ need not necessarily be
isomorphic to each other.

\medskip
\diffasch7 
We define \DD7 including more conditions on the structure of the group
and its natural representation than Aschbacher. On the other hand we
have added some subgroups of the members of \CC7.

\smallskip
\textbf{Note:} 
If $G$ is a
group in \DD7, then its natural projective representation
is tensor-induced,
see Proposition~\ref{tensorindprop}. However, the natural
representation of $G$ needs not be tensor-induced as is shown in
Remark~\ref{nottensorind} by an example.

\smallskip
\exmemb
The following subgroups of $\GL(n,q)$ lie in \DD7:
$\GL(r,q)^{\otimes k}.S_k$ where $n=r^k$ and $\GL(r,q)^{\otimes k}$ 
denotes the central product of $k$ copies of $\GL(r,q)$.

\subsection{Description of class \DD8: ``classical''}
\label{descC8}

\desc{
A group $G \le \GL(n,q)$ lies in \DD8 if $G/Z$ contains a classical simple
group in its natural representation in one of the following ways:
\begin{itemize}\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}
\item $G/Z$ contains $\PSL(n,q)$ and $(n,q) \notin \{(2,2),(2,3)\}$,
\item $n$ is even, $G$ is contained in $\Sp(n,q)$ for some non-singular 
symplectic form, $G/Z$ contains $\PSp(n,q)$ and $(n,q) \notin           
\{(2,2),(2,3),(4,2)\}$,
\item $q$ is a square, $G$ is contained in $U(n,q)$ for some non-singular 
Hermitian form, $G/Z$ contains $\PSU(n,q)$ and $(n,q) \notin \{ (2,4),
(2,9), (3,4) \}$,
\item $G$ is contained in $O^\epsilon(n,q)$, the corresponding
    $\POmega^\epsilon(n,q)$ is simple and contained in $G/Z$.
    $\POmega^\epsilon(n,q)$ is simple if and only if
    \begin{itemize}\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}
        \item[*] $n\ge 3$, and
        \item[*] $q$ is odd if $n$ is odd, and
        \item[*] $\epsilon$ is -- if $n=4$, and
        \item[*] $(n,q) \notin \{ (3,3), (4,2) \}$.
    \end{itemize}
\end{itemize}
}

\textbf{Note:} For the orthogonal groups the given restrictions on $(n,q)$
are necessary for $\POmega^{(\pm)}(n,q)$ to be simple, see
\cite[Section~2.4]{ATLAS} for details.

\medskip
\diffasch8
We only include groups in \DD8 that modulo scalars contain a simple 
classical group in its natural representation defined over $\F_q$.


\subsection{Description of class \DD9: ``almost-simple''}
\label{descC9}

\desc{
A group $G \le \GL(n,q)$ lies in \DD9, if it is not in \DD8 and
there is a non-abelian simple
group $\bar N$ and a group $T$ with $\bar N \subseteq T \subseteq \Aut(\bar N)$ 
such that $G/Z$ is isomorphic to $T$ (in this case $G/Z$ is called
``almost-simple'') and
the natural module $V$ gives rise to an
absolutely irreducible projective representation for $T$ that
is not realisable over a proper subfield of~$\F_q$.}

\textbf{Note:} The existence of the projective representation given by $V$
limits the possibilities for $\bar N$ and $T$ for given $(n,q)$ and thus
provides an interesting application for the representation theory of finite
simple groups, their Schur covers and automorphism groups.

\medskip
\diffasch9
Aschbacher does not call this class \CC9 but in the literature many
authors have called this ``Aschbacher class \CC9``.

\smallskip
\exmemb
The absolutely irreducible projective representations of the
quasi-simple groups provide examples of groups in \DD9.


\section{A proof of the $\mathbf{\GL}$-version of Aschbacher's Theorem}
\label{AschProof}

The contents of this section are a variation on ``The Theory behind
\textsc{Smash}'' from \cite[Section~2]{smashnormal} and provide a proof for
Theorem~\ref{Asch}. The part about the semilinear action is copied
from Section~\ref{subsec:semilin} and thus from 
\cite[Section~6.4]{subfieldpaper}.

Let $G$ be any subgroup of $\GL(n,q)$ acting from the right on the
natural module $V := \F_q^{1 \times n}$.

If the natural module $V$ is reducible, then $G$ is contained in class \DD1
as defined in Section~\ref{descC1}.

From now on we assume that $V$ is irreducible.

If $V$ is not absolutely irreducible, then by \cite[(29.13)]{CR0} and the 
usual Wedderburn Theorems
the endomorphism ring $\End_{\F_q G}(V)$ is a proper finite extension field
$\F_{q^s}$ of $\F_q$. This automatically extends the $\F_q$-vector
space structure of $V$ to an $\F_{q^s}$-vector space structure
such that the $G$-action is $\F_{q^s}$-linear. Thus $G$ lies in class
\DD3 (see \ref{descC3}) with trivial Galois automorphisms.

From now on we assume that $V$ is absolutely irreducible. Let $Z$ be the
subgroup of scalar matrices contained in $G$, i.e.~$Z := G \cap
Z(\GL(n,q))$. Since $V$ is absolutely irreducible it follows that $Z$ is
the centre of $G$.

At this stage of the proof we mention that obviously $G$ can lie
in \DD5 (see \ref{descC5}).

From now on we assume that $G$ does not lie in \DD5. In the sequel this 
assumption will be used to rule out classical groups defined over
smaller fields and achieve the corresponding statement in class \DD9
(see \ref{descC9}).

We assume first that $G/Z$ is a simple group. If $G/Z$ were cyclic of prime 
order, then $G$ would be abelian and $V$ could not be absolutely
irreducible contrary to our assumptions.

There are two possibilities:
The first is that $G/Z$ is one of the
classical simple groups in its natural representation defined over $\F_q$
and $G$ lies in \DD8 (see
\ref{descC8}). Note that by our assumption of $G$ not lying in \DD5 we can
exclude classical simple groups defined over a proper subfield. Otherwise
$G$ lies in \DD9 (see \ref{descC9}) with
$\bar N =T \cong G/Z$ since $V$ gives rise to an absolutely irreducible
projective representation of the finite simple group $G/Z$ that
is by assumption not realisable over a proper subfield of $\F_q$.

We assume from now on that $G/Z$ is not simple, let $\bar N$
be a non-trivial minimal normal subgroup of $G/Z$ and $N$ be
the corresponding non-scalar normal subgroup of $G$ with $Z < N
\triangleleft G$.

We now use Clifford theory applied to the natural module $V$. By Clifford's
theorem (see \cite[(49.2) and (49.7)]{CR0}) the restricted $\F_q N$-module
$V|_N$ is a direct sum of irreducible $\F_q N$-modules which are all
$G$-conjugates of one irreducible $\F_q N$-submodule $W \le V|_N$. In
particular, all these irreducible summands have the same dimension. We now
distinguish several cases.

If there is more than one homogeneous component (i.e.~not all conjugates of
$W$ are isomorphic to $W$ as $\F_q N$-modules), then $G$ lies in \DD2
(see \ref{descC2}),
since the homogeneous components provide a direct sum decomposition that is
preserved by $G$ and the summands are permuted transitively.

From now on we assume additionally that there is only one homogeneous
component, that is, all $Wg$ are isomorphic to $W$ as $\F_q N$-modules.
Then $\dim W > 1$ because $N$ is non-scalar.

We first assume that $W$ is not absolutely irreducible including both
cases $W = V$ and $W < V$. Then $\End_{\F_q N}(W)$ is a proper finite
extension field of $\F_q$, say $\F_{q^s}$, and $W$ and $V|_N$
both can be considered as $\F_{q^s}$-vector spaces such that the action of
$N$ on them is $\F_{q^s}$-linear, because $V|_N$ is isomorphic to a direct
sum of copies of $W$. We can embed $\F_{q^s} \le \End_{\F_q N}(V) \le \GL(n,q)$.

We claim that the action of $G$ is $\F_{q^s}$-semilinear proving that $G$ lies
in \DD3 (see \ref{descC3}). Let $c \in \GL(n,q)$ generate the
multiplicative group of $\F_{q^s}$. Then, for all $h \in N$ and $g
\in G$, we have $hc=ch$ by definition and thus $h^g c^g = c^g h^g =
h' c^g = c^g h'$, for some $h' \in N$. As $h$ varies over $N$, the
element $h'$ takes every value in $N$, therefore $\left< c \right>
= \left< c^g \right>$ and so $c^g = c^k$ for some $k$. Suppose that
$c^i + c^j = c^l$, then $(c^i)^g + (c^j)^g = (c^l)^g$ so $g$ acts as
field automorphism on $\F_{q^s}$. We have thus proved that $G$ 
lies in \DD3 (see \ref{descC3}).

From now on we assume that $W$ is absolutely irreducible.

We first assume that $W$ is a proper subspace of $V$. Let $d :=
\dim_{\F_q}(W)$ such that $1 < d < n$. Since by assumption 
all $G$-conjugates of $W$ are isomorphic to $W$ as $\F_q N$-modules,
we have shown that $G$ lies in \DD4 (see \ref{descC4}).

We now move on to the case that $W = V|_N$, that is, the restriction
$V|_N$ is irreducible. We are still assuming that $W$ is
absolutely irreducible.

Recall that by assumption $\bar N$ is a minimal normal subgroup of $G/Z$.
As such, by \cite[Theorem 4.3A.(iii)]{DixonMort}, it is
a direct product $\bar T_1 \times \cdots \times \bar T_k$ of copies of a 
simple group $\bar T$ which are all conjugate under $G/Z$. Thus $N$ is
a central product of the corresponding preimages $T_1, \ldots, T_k$
under the natural map $G \to G/Z$. We now distinguish three cases:
\begin{itemize}\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}
\item[(i)] $\bar T$ is cyclic of prime order $r$, 
\item[(ii)] $\bar T$ is non-abelian simple with $k > 1$ and
\item[(iii)] $N/Z$ is non-abelian simple.
\end{itemize}
We now consider case (i) that $\bar T$ is cyclic of prime order $r$, then
$\bar N = N/Z$ is an elementary-abelian $r$-group of order $r^k$.
Since $N$ is not abelian, we have $k > 1$.
The commutator subgroup $N'$ of $N$ is contained in $Z$ and
we recall that $Z$ is the centre of $N$ since $V|_N$ is absolutely
irreducible. So $N$ is nilpotent and thus the direct product of its
Sylow subgroups. Let $R$ be the $r$-Sylow subgroup of $N$, all other
Sylow subgroups of $N$ consist of scalar matrices since $N/Z$ is
elementary abelian. Thus the module $V|_R$ is absolutely irreducible
and $R$ is not abelian.
For $x,y \in R$, we have $1 = [x^r,y] = [x,y]^r$ since $x^r$ and 
$[x,y]$ lie in $Z(R) = R \cap Z$. Therefore $R'=N'$ has exponent $r$ and
because it is contained in the cyclic group $Z(R) \le Z$ we have $|R'| =
r = |N'|$.

Assume first that $r$ is odd. For $x,y \in R$ we have $(xy)^r =
x^ry^r[y,x]^{r(r-1)/2} = x^ry^r$ since $R'$ has order $r$, thus the
elements of $R$ whose order divides $r$ form a characteristic 
subgroup of $N$ and thus a normal subgroup $E$ of $G$. Since for
$r$ odd, an $r$-group containing a unique subgroup of order $r$ is
cyclic, $E$ is not contained in $Z$ and thus by the minimality
of $N/Z$ we have $Z E = N$. It immediately follows that $V|_E$
is absolutely irreducible, $E$ is not abelian, 
$E \cap Z = Z(E) = E' = R' = N'$ has $r$ elements and 
$N/Z = ZE/Z \cong E/(E \cap Z) = E/Z(E)$. Thus the Frattini subgroup
$\Phi(E)$ of $E$ is equal to $Z(E)$ and $E$ is shown to be extraspecial
of order $r^{1+k}$ and exponent $r$. It follows using
\cite[V.16.14]{Hup} that $k$ is even and
$n=r^{k/2}$ because this holds for the faithful absolutely irreducible
representations of an extraspecial group. The linear action of $G$ on
the $\F_r$-vector space $E/Z(E)$ is irreducible because every minimal
normal subgroup of $N/Z \cong E/Z(E)$ is conjugated to a full basis by
$G$. Hence $G$ lies in \DD6 with odd $r$.

Consider now $r=2$. Recall $R' \le Z$ with $|R'| = 2$ and
let $E$ be the set of elements $x \in R$ with $x^2 \in R'$. 
For $x,y \in E$ we have $(xy)^2 = x^2y^2[y,x] \in R'$ proving that
$E$ is a characteristic subgroup of $R$ and thus a normal subgroup of
$G$. We claim that $E$ is not contained in $Z$: If $4$ does not divide
$|Z(R)|$ then this is trivial. If $4$ divides $|Z(R)|$ and $xZ(R)$ and $yZ(R)$
are different elements of $R/Z(R)$, then at least one of
$x^2$, $y^2$ and $(xy)^2$ is a square in the cyclic group $Z(R)$ and
thus one of $x$, $y$ and $xy$ can be multiplied by an element of
$Z(R)$ to get an involution. Therefore $R$ and thus $E$ both contain a 
non-central element whose square is contained in $R'$.
By the minimality of $N/Z$ we have $Z E = N$ as above. We immediately
get that $V|_E$ is absolutely irreducible, $E$ is not abelian,
$E \cap Z = Z(E)$ is cyclic with either $2$ or $4$ elements and
$E' = R' = N'$ has $2$ elements and is contained in $Z(E)$.
Furthermore, $N/Z = ZE/Z \cong E/(E \cap Z) = E/Z(E)$. Thus the
Frattini subgroup $\Phi(E)$ of $E$ is equal to $E'$ and $E$ is either
extraspecial of order $2^{1+k}$ or a central product of a cyclic group
of order $4$ consisting of scalar matrices and an extraspecial group 
of order $2^{1+k}$. In both cases it follows again using
\cite[V.16.14]{Hup} that $k$ is even and
$n = 2^{k/2}$. As above the linear action of $G$ on the $\F_2$-vector space
$E/Z(E)$ is irreducible and thus $G$ lies in \DD6 with $r=2$.

This concludes case (i) that $\bar T$ is cyclic of prime order $r$.

We now consider case (ii) that $\bar N$ is a direct product of more than
one copies of a non-abelian simple group $\bar T$. Thus $N$ is a
central product of the groups $T_1, \ldots, T_k$, each of which is
isomorphic to a single group $T$, which is a central extension of
$\bar T$ by $Z$. The absolutely irreducible representations
of $N$ in which $Z$ acts as scalars are just tensor products of 
absolutely irreducible representations of $T$ in which $Z \le T$ acts as
scalars. Furthermore, since $T_1, \ldots, T_k$ are all conjugate under
$G$, the natural module $V|_N$ must be isomorphic to an outer tensor product
$W_1 \otimes_{\F_q} \cdots \otimes_{\F_q} W_k$ 
of $k$ absolutely irreducible $\F_q T$-modules $W_i$ on which $Z$
acts as scalars. Since $G/N$ acts on $N$ by permuting the factors
transitively, all modules $W_i$ have the same dimension. So $G$ lies in
\DD7 concluding case~(ii).

We finally consider case (iii) that $\bar N = N/Z$ is a non-abelian finite 
simple group. Since in this case the centraliser $C_{\bar N}(\bar N)$ is 
trivial, $G/Z$ is contained in the automorphism group of $\bar N$. 
Thus either $N$ is a classical simple group in its natural
representation defined over $\F_q$ and
$G$ lies in \DD8, or $G$ lies in \DD9. Note that the assumptions we
picked up along the way of this proof now allow to conclude that $V$
gives rise to an absolutely irreducible projective representation for
$G$ which is not realisable over a subfield (since $G$ is not \DD5).
\proofend

\medskip
In the rest of this section we present results relating our class
definitions to those of Aschbacher and to other concepts of group
representations.

\begin{Prop}[\DD4 implies tensor decomposability]
    \label{tensorprop}
If a group $G \le \GL(n,q)$ lies in \DD4, then it is tensor decomposable,
by which we mean the following:
there is a decomposition
of\/ $V = V_1 \otimes V_2$ into a tensor product with 
$1 < d_1 := \dim_{\F_q}(V_1) < n$
and $d_2 := \dim_{\F_q}(V_2)$ that is preserved by $G$, 
that is, for every $g \in
G$ there are elements $g_1 \in \End_{\F_q}(V_1)$ and $g_2 \in
\End_{\F_q}(V_2)$ such that $(v_1 \otimes v_2) g = v_1 g_1 \otimes v_2 g_2$
for all $v_1 \in V_1$ and $v_2 \in V_2$.
\end{Prop}
\proofbeg
This proof is copied from Section~\ref{subsec:tensor} and thus from 
\cite[Section~6.6]{subfieldpaper}.

We assume that $G$ lies in \DD4, so the natural module $V$ is
absolutely irreducible and $G$ has a normal subgroup $N$ such that
$V|_N$ is isomorphic to a direct sum of $k>2$ modules which are all
isomorphic to a single absolutely irreducible $\F_q N$-module $W$
of dimension $d < n$.

It immediately follows that we can choose a basis of $V$ such that all
elements of $N$ are block diagonal matrices in which all diagonal blocks
are identical of size $d$.

As $N \triangleleft G$, for all $h \in N$ and $g \in G$,
 the product $g^{-1}hg \in N$ and thus $g^{-1} h g$ is also 
a block diagonal matrix in which all $d \times d$-blocks along the diagonal
are identical. Fixing $g$, we conclude that $g\cdot (g^{-1}hg) = hg$ for all
$h \in N$. If we now cut $g$ into $d \times d$-blocks, we get:

\begin{eqnarray*}
   &g \cdot (g^{-1}hg) & 
 = \left[ \begin{array}{c|c|c|c}
      g_{1,1} & g_{1,2} & \cdots & g_{1,n/d} \\ \hline
      g_{2,1} & g_{2,2} & \cdots & g_{2,n/d} \\ \hline
      \vdots  & \vdots  & \ddots & \vdots    \\ \hline
      g_{n/d,1}&g_{n/d,2}& \cdots& g_{n/d,n/d} \end{array} \right]
\cdot \left[ \begin{array}{c|c|c|c}
      D^g(h) & 0   & \cdots &      0    \\ \hline
         0   &D^g(h)&\cdots &      0    \\ \hline
      \vdots  & \vdots  & \ddots & \vdots    \\ \hline
         0    &    0    & \cdots& D^g(h) \end{array} \right] \\
 &=& \left[ \begin{array}{c|c|c|c}
      D(h)    & 0       & \cdots &     0    \\ \hline
         0    &D(h)     &\cdots &      0    \\ \hline
      \vdots  & \vdots  & \ddots & \vdots    \\ \hline
         0    &    0    & \cdots& D(h)   \end{array} \right]
\cdot \left[ \begin{array}{c|c|c|c}
      g_{1,1} & g_{1,2} & \cdots & g_{1,n/d} \\ \hline
      g_{2,1} & g_{2,2} & \cdots & g_{2,n/d} \\ \hline
      \vdots  & \vdots  & \ddots & \vdots    \\ \hline
      g_{n/d,1}&g_{n/d,2}& \cdots& g_{n/d,d/n} \end{array} \right]
 = hg
\end{eqnarray*}
where the $g_{i,j}$ are $d \times d$-matrices, $D(h)$ is a matrix
representing $h$ on the module $W$ and $D^g(h) = D(g^{-1}hg)$ is the
same representation twisted by the element $g$. By the block diagonal
structure of the matrices in $N$ we get 
$g_{i,j} \cdot D^g(h) = D(h) \cdot g_{i,j}$ for all $i$ and $j$ and 
all $h \in N$.

But by hypothesis, the matrix representations $D$ and $D^g$ of $N$
are isomorphic. Thus there is a nonzero matrix $T \in \F_q^{d \times d}$ with
$T \cdot D^g(h) = D(h) \cdot T$ for all $h \in N$. By Schur's lemma and
since the representation $D$ is absolutely irreducible,
the matrix $T$ is invertible and unique 
up to multiplication by an element in $C_{\GL(d,q)}(D(N))$, which
consists only of the scalar matrices.

This shows that for every pair $(i,j) \in \{ 1, \ldots, d/n \} \times 
\{ 1, \ldots, d/n \}$ there
is a unique element $e_{i,j} \in \F_q$ (possibly $0$) with 
$g_{i,j} = T \cdot e_{i,j}$. Thus we have shown that with respect to
the above choice of basis, every element $g$ is equal to a Kronecker 
product of some matrix in $U \in \F_q^{n/d \times n/d}$ with a matrix
$T \in \F_q^{d \times d}$. Since $g$ is invertible both 
$U$ and $T$ are invertible. 

This provides an $\F_q$-linear isomorphism of 
$\F_q^n$ and the tensor product $\F_q^{n/d} \otimes_{\F_q} \F_q^d$
such that all $g \in G$ act as a Kronecker product proving the
proposition.
\proofend

\begin{DefProp}[{Tensor induction of (projective) representations}]
    For details and proofs see \cite[13A]{CRI} and \cite[Section~2]{kovacs}.

    Let $G$ be a group, $K$ an arbitrary field, $H<G$ a subgroup of
    index $k$ and $G=\bigcup_{i=1}^k g_i H$ with $g_1,\ldots,g_k \in
    G$ and $g_1=1$. Let $\varphi : G \to H \wr S_k$ be the group
    monomorphism defined by $\varphi(x) = \pi \cdot (h_1,\ldots,h_k)$
    for $x \in G$, where $xg_i = g_{\pi(i)}h_i$ with $\pi \in S_k$
    and $h_i \in H$ for $1 \le i \le k$.
    Let $\kappa$ be the group homomorphism $\kappa: \GL(d,K)
    \wr S_k \to \GL(d^k,K)$ where the direct factors of the base group
    act on the tensor factors of $(K^d)^{\otimes k} \cong K^{d^k}$ and
    the top group permutes them. Let $\bar\kappa : \PGL(d,K) \wr S_k
    \to \PGL(d^k,K)$ be the corresponding map for the projective linear
    group.

    For a representation $\rho: H \to \GL(d,K)$ of $H$
    there is a corresponding map $(\rho \wr S_k) : H \wr S_k \to
    \GL(d,K) \wr S_k$ mapping the base group component-wise by $\rho$. 
    The \emph{tensor-induced representation}
    $\rho\!\uparrow^{\otimes G} : G \to \GL(d^k,K)$ is then the
    composite map $\kappa \circ (\rho \wr S_k) \circ \varphi$. The
    equivalence class of this representation does not depend on the
    choices in this construction.

    Similarly,
    for a projective representation $\bar\rho : H \to \PGL(d,K)$ of
    $H$ there is a corresponding map $(\bar\rho \wr
    S_k) : H \wr S_k \to \PGL(d,K)$ mapping the base group
    component-wise by $\bar\rho$.
    The \emph{tensor-induced projective representation}
    $\bar\rho\!\uparrow^{\otimes G} : G \to \PGL(d^k,K)$ is then the
    composite map $\bar\kappa \circ (\bar\rho \wr S_k) \circ \varphi$.
    The equivalence class of this projective representation does not
    depend on the choices in this construction.
\end{DefProp}

\begin{Prop}[\DD7 implies ``projective tensor-induced'']
    \label{tensorindprop}
If a group $G \le \GL(n,q)$ lies in \DD7, then the projective
representation afforded by its natural module is tensor-induced.
\end{Prop}
\proofbeg
Let $G$ be in \DD7 and let $N$, $T$, $Z$ and $V$ be as in
Section~\ref{descC7}.
We can use the proof of \cite[Tensor Induction Theorem]{kovacs}. 
Although the hypotheses of
the theorem contain that the natural module is not induced from a any
proper subgroup, this is only used in the proof to ensure that the
constituents of the restricted natural module $V|_N$ are all
equivalent and absolutely irreducible. However, we have this by
assumption and the proof goes through.
\proofend

\begin{Rem}[{\DD7 does \emph{not} imply tensor-induced}]
    \label{nottensorind}
    Let $G$ be the semidirect product 
    $(\SL(2,7) \otimes_{\F_7} \SL(2,7)).S_2 < \GL(4,7)$ where the
    $S_2$ permutes the tensor factors. The natural module $V := \F_7^4$ is
    absolutely irreducible also when restricted to the normal subgroup
    $N := \SL(2,7) \otimes_{\F_7} \SL(2,7)$ of index $2$. The center 
    $Z := \left< -\id \right>$ of $G$ has $2$ elements and $N/Z$ is a
    minimal normal subgroup of $G/Z$ which is a direct product of two
    copies of the non-abelian simple group $\PSL(2,7)$. Thus $G$ lies
    in \DD7 by construction.

    However, $G$ does not have a subgroup of index $4$, the only 
    subgroup of $G$ of index $2$ is $N$ and $N$ does
    not have an irreducible representation of dimension $2$ over
    $\F_7$. Thus the natural module is not tensor-induced.

    Of course, using Proposition~\ref{tensorindprop} we conclude that
    the projective representation afforded by the natural module is in
    fact tensor-induced from the two-dimensional projective
    absolutely irreducible representation of $N$ over $\F_7$.
\end{Rem}

\section{Finding reductions}
\label{findred}

The purpose of this section is to give an overview how reductions can
be found algorithmically provided that a matrix group
lies in one of the classes \DD1 to \DD7. We do not give full details
here but rather sketch the methods used and collect references into the
literature.

We continue to use the notation for a group $G < \GL(n,q)$ that
$Z := Z(\GL(n,q)) \cap G$ is the subgroup of scalar matrices and that
$V := \F_q^{1 \times n}$ is the natural right module. For the
complexity statements we assume that $G$ is given by $m$ generators
$g_1, \ldots, g_m \in \GL(n,q)$.

\subsection{Finding a reduction in the reducible case: \DD1}
\label{solveC1}

Using the MeatAxe (see \cite{MeatAxeHoltRees, IL, MeatAxeRP}) we can
decide efficiently whether the natural module $V$ is
irreducible. If not, we find a proper invariant subspace $0<W<V$
thereby finding a reduction as described in Section~\ref{descC1}. 
If $V$ is irreducible, we either prove
that it is absolutely irreducible or find an element that generates
the endomorphism ring as a field.

Under the assumptions in Section~\ref{hypMtx} the MeatAxe provides a
Las Vegas algorithm which terminates
after at most $O(mn^3\log \delta^{-1})$ elementary field operations where $m$
is the number of generators of $G$ and $0 < \delta < 1/2$ is an upper
bound for the failure probability (see Lemma~\ref{MeatAxe}).


\subsection{Finding a reduction in the semilinear or subfield case:
\DD3/\DD5}
\label{solveC3C5}

Chapter~\ref{chap:subsemi} deals with the case that $G$ does not lie
in \DD1.


\subsection{Finding a reduction in the extraspecial case: \DD6}
\label{solveC6}

\subsection{Finding a reduction in the imprimitive case: \DD2}
\label{solveC2}

\subsection{Finding a reduction in the tensor-decomposable case: \DD4}
\label{solveC4}

\subsection{Finding a reduction in the tensor-induced case: \DD7}
\label{solveC7}



